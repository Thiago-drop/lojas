<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minha Loja E-commerce - React App</title>
    <!-- Carrega Tailwind CSS via CDN para estilização -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configuração do Tailwind para usar a fonte Inter -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Define a fonte Inter para toda a página */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }
    </style>

    <!-- Carrega as bibliotecas do React e Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Carrega React Router DOM (versão 6) -->
    <script src="https://unpkg.com/react-router-dom@6.11.2/dist/main.js"></script>
</head>
<body>
    <!-- Ponto de montagem da aplicação React -->
    <div id="root"></div>

    <script type="text/babel">
        // Importa componentes do React Router DOM globalmente
        const { 
            BrowserRouter: Router, 
            Routes, 
            Route, 
            Link, 
            useParams, 
            useLocation, 
            useNavigate 
        } = ReactRouterDOM;

        const { useState, useMemo } = React;

        // --- DADOS MOCK (Simulando um banco de dados de produtos) ---
        const PRODUCTS = [
            { id: 1, title: "Vestido Floral de Verão", price: 129.90, img: "https://placehold.co/200x250/5F46A9/ffffff?text=Vestido+Floral", description: "Um vestido leve e fresco, perfeito para dias ensolarados. 100% algodão." },
            { id: 2, title: "Camisa Social Slim", price: 99.50, img: "https://placehold.co/200x250/2E2E2E/ffffff?text=Camisa+Slim", description: "Elegância e conforto no trabalho. Corte moderno, fácil de passar." },
            { id: 3, title: "Tênis Esportivo Pro", price: 249.00, img: "https://placehold.co/200x250/33A8FF/ffffff?text=Tênis+Pro", description: "Máximo desempenho para corrida e treino. Solado de alta absorção de impacto." },
            { id: 4, title: "Calça Jeans Skinny", price: 159.90, img: "https://placehold.co/200x250/003366/ffffff?text=Jeans+Skinny", description: "Jeans premium com elasticidade. O ajuste perfeito para o seu dia a dia." },
        ];

        // --- COMPONENTES AUXILIARES ---

        // Icone do Carrinho (usando SVG inline)
        const ShoppingCartIcon = (props) => (
            <svg {...props} xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.023.824l3.514 14.881a1.2 1.2 0 001.12 1.09h10.404a1.2 1.2 0 001.12-1.09l3.514-14.881c.068-.481-.35-.824-.863-.824H2.25z" />
            </svg>
        );

        // Cabeçalho da aplicação
        const Header = ({ cartCount, onOpenCart }) => {
            const location = useLocation();
            const path = location.pathname;

            return (
                <header className="bg-white shadow-md sticky top-0 z-10">
                    <div className="container mx-auto px-4 py-4 flex justify-between items-center">
                        {/* Logo/Marca */}
                        <Link to="/" className="text-2xl font-bold text-indigo-600">
                            Minha Loja
                        </Link>

                        {/* Navegação Principal */}
                        <nav className="hidden md:flex space-x-6 text-gray-600 font-medium">
                            <NavLink to="/" currentPath={path}>Início</NavLink>
                            <NavLink to="/shop" currentPath={path}>Produtos</NavLink>
                            <NavLink to="/about" currentPath={path}>Sobre</NavLink>
                            <NavLink to="/account" currentPath={path}>Minha Conta</NavLink>
                        </nav>

                        {/* Botão do Carrinho */}
                        <div className="flex items-center space-x-4">
                            <button
                                onClick={onOpenCart}
                                className="relative p-2 rounded-full text-indigo-600 hover:bg-indigo-50 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500"
                                aria-label="Abrir carrinho de compras"
                            >
                                <ShoppingCartIcon className="w-6 h-6" />
                                {cartCount > 0 && (
                                    <span className="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full">
                                        {cartCount}
                                    </span>
                                )}
                            </button>
                        </div>
                    </div>
                </header>
            );
        };

        // Componente de Link com estilo ativo
        const NavLink = ({ to, children, currentPath }) => (
            <Link
                to={to}
                className={`hover:text-indigo-600 transition-colors pb-1 ${
                    currentPath === to ? 'text-indigo-600 border-b-2 border-indigo-600' : ''
                }`}
            >
                {children}
            </Link>
        );


        // Rodapé da Aplicação
        const Footer = () => (
            <footer className="bg-gray-800 text-white mt-10">
                <div className="container mx-auto p-8 text-center text-sm">
                    <p>&copy; {new Date().getFullYear()} Minha Loja E-commerce. Todos os direitos reservados.</p>
                    <div className="flex justify-center space-x-4 mt-2">
                        <Link to="/about" className="hover:underline">Termos de Serviço</Link>
                        <Link to="/about" className="hover:underline">Política de Privacidade</Link>
                    </div>
                </div>
            </footer>
        );

        // --- PÁGINAS DA ROTA ---

        // Página Inicial
        const Home = () => (
            <div className="container mx-auto p-6 lg:p-10">
                <div className="bg-indigo-700 text-white p-10 rounded-xl shadow-lg text-center mb-10">
                    <h1 className="text-4xl md:text-5xl font-extrabold mb-3">Bem-vindo(a) à Minha Loja!</h1>
                    <p className="text-xl opacity-90">Descubra as últimas tendências e ofertas exclusivas.</p>
                    <Link to="/shop" className="mt-6 inline-block bg-white text-indigo-700 font-semibold px-8 py-3 rounded-full hover:bg-gray-200 transition-colors shadow-md">
                        Começar a Comprar
                    </Link>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div className="bg-white p-6 rounded-lg shadow-md">
                        <h2 className="text-xl font-bold text-indigo-600 mb-2">Entrega Rápida</h2>
                        <p className="text-gray-600">Receba seus produtos em até 48h nas principais capitais.</p>
                    </div>
                    <div className="bg-white p-6 rounded-lg shadow-md">
                        <h2 className="text-xl font-bold text-indigo-600 mb-2">Suporte 24/7</h2>
                        <p className="text-gray-600">Nossa equipe de atendimento está sempre pronta para ajudar.</p>
                    </div>
                    <div className="bg-white p-6 rounded-lg shadow-md">
                        <h2 className="text-xl font-bold text-indigo-600 mb-2">Devolução Fácil</h2>
                        <p className="text-gray-600">Troque ou devolva em até 30 dias sem complicações.</p>
                    </div>
                </div>

                <section className="mt-12 text-center">
                    <h2 className="text-3xl font-bold text-gray-800 mb-6">Destaques da Semana</h2>
                    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        {PRODUCTS.slice(0, 4).map(product => (
                            <ProductCard key={product.id} product={product} onAdd={() => { /* Mock add */ }} isHome={true} />
                        ))}
                    </div>
                </section>
            </div>
        );

        // Card de Produto
        const ProductCard = ({ product, onAdd, isHome = false }) => {
            // Reduz a descrição para caber no card da Home
            const displayDescription = isHome
                ? product.description.length > 50 ? product.description.substring(0, 47) + '...' : product.description
                : product.description;

            return (
                <div className="bg-white rounded-xl shadow-lg overflow-hidden transition-transform hover:shadow-xl hover:scale-[1.02]">
                    <Link to={`/product/${product.id}`}>
                        <img src={product.img} alt={product.title} className="w-full h-64 object-cover" onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/200x250/cccccc/333333?text=Imagem"}}/>
                    </Link>
                    <div className="p-4">
                        <h3 className="text-lg font-semibold truncate text-gray-800">{product.title}</h3>
                        <p className="text-sm text-gray-500 mt-1 h-12 overflow-hidden">{displayDescription}</p>
                        <div className="mt-3 flex justify-between items-center">
                            <span className="text-xl font-bold text-indigo-600">R${product.price.toFixed(2)}</span>
                            <button
                                onClick={() => onAdd(product)}
                                className="bg-indigo-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-600 transition-colors shadow-md"
                            >
                                Comprar
                            </button>
                        </div>
                    </div>
                </div>
            );
        };


        // Página da Loja (Lista de Produtos)
        const Shop = ({ onAdd }) => (
            <div className="container mx-auto p-6 lg:p-10">
                <h1 className="text-3xl font-bold text-gray-800 mb-8 border-b pb-2">Nossos Produtos</h1>
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                    {PRODUCTS.map(product => (
                        <ProductCard key={product.id} product={product} onAdd={onAdd} />
                    ))}
                </div>
            </div>
        );

        // Página de Produto Detalhada
        const ProductPage = ({ onAdd }) => {
            const { id } = useParams();
            const product = PRODUCTS.find(p => p.id === parseInt(id));

            if (!product) {
                return <div className="container mx-auto p-10 text-center text-red-600">Produto não encontrado.</div>;
            }

            return (
                <div className="container mx-auto p-6 lg:p-10">
                    <div className="bg-white shadow-xl rounded-xl p-6 md:flex gap-10">
                        {/* Imagem */}
                        <div className="md:w-1/2 flex justify-center">
                            <img
                                src={product.img}
                                alt={product.title}
                                className="w-full max-w-sm h-96 object-cover rounded-xl shadow-lg"
                                onError={(e) => {e.target.onerror = null; e.target.src="https://placehold.co/400x400/cccccc/333333?text=Imagem+Detalhe"}}
                            />
                        </div>

                        {/* Detalhes */}
                        <div className="md:w-1/2 mt-6 md:mt-0">
                            <h1 className="text-4xl font-extrabold text-gray-900">{product.title}</h1>
                            <p className="text-2xl font-bold text-indigo-600 mt-4">R${product.price.toFixed(2)}</p>
                            <div className="mt-6">
                                <h2 className="text-xl font-semibold mb-2">Descrição:</h2>
                                <p className="text-gray-700 leading-relaxed">{product.description}</p>
                            </div>

                            <button
                                onClick={() => onAdd(product)}
                                className="mt-8 w-full md:w-auto bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg shadow-lg hover:bg-indigo-700 transition-colors"
                            >
                                Adicionar ao Carrinho
                            </button>

                            <div className="mt-8 p-4 bg-indigo-50 rounded-lg text-indigo-800">
                                <h3 className="font-semibold">Informações Adicionais</h3>
                                <ul className="list-disc list-inside mt-2 text-sm">
                                    <li>Frete grátis para compras acima de R$ 200.</li>
                                    <li>Disponível nos tamanhos P, M, G, GG.</li>
                                    <li>Estoque limitado!</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Página de Checkout (Finalização de Compra)
        const Checkout = ({ cart, onClear }) => {
            // Agora usando o hook useNavigate nativo do react-router-dom
            const navigate = useNavigate();

            const cartTotal = useMemo(() => cart.reduce((s, i) => s + i.price * i.qty, 0), [cart]);

            // Simula a finalização da compra
            const handleCheckout = (e) => {
                e.preventDefault();
                // Substituído alert() por console.error e navegação condicional
                if (cart.length === 0) {
                    console.error("Tentativa de finalizar compra com carrinho vazio.");
                    return;
                }
                // Simulação de processamento
                setTimeout(() => {
                    onClear(); // Limpa o carrinho após a "compra"
                    navigate('/thankyou'); // Redireciona para a página de agradecimento
                }, 500);
            };

            if (cart.length === 0) {
                return (
                    <div className="container mx-auto p-10 text-center">
                        <h1 className="text-3xl font-bold text-gray-800 mb-4">Finalização de Compra</h1>
                        <p className="text-gray-600">Parece que seu carrinho está vazio. Visite a <Link to="/shop" className="text-indigo-600 hover:underline">loja</Link> para começar a comprar!</p>
                    </div>
                );
            }

            return (
                <div className="container mx-auto p-6 lg:p-10 grid grid-cols-1 lg:grid-cols-3 gap-8">
                    {/* Coluna de Detalhes do Pedido (esquerda) */}
                    <div className="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                        <h1 className="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Detalhes do Pedido</h1>

                        <div className="space-y-4">
                            {cart.map(item => (
                                <div key={item.id} className="flex items-center gap-4 border-b pb-4">
                                    <img src={item.img} alt={item.title} className="w-16 h-20 object-cover rounded" />
                                    <div className="flex-1">
                                        <p className="font-semibold">{item.title}</p>
                                        <p className="text-sm text-gray-500">Qtd: {item.qty}</p>
                                    </div>
                                    <p className="font-bold text-lg text-indigo-600">R$ {(item.price * item.qty).toFixed(2)}</p>
                                </div>
                            ))}
                        </div>

                        <div className="mt-6 pt-4 border-t">
                            <div className="flex justify-between font-semibold text-xl">
                                <span>Total a Pagar:</span>
                                <span className="text-indigo-600">R$ {cartTotal.toFixed(2)}</span>
                            </div>
                        </div>
                    </div>

                    {/* Coluna de Formulário de Pagamento (direita) */}
                    <div className="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg h-fit">
                        <h2 className="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Informações de Pagamento</h2>
                        <form onSubmit={handleCheckout} className="space-y-4">
                            <div>
                                <label htmlFor="name" className="block text-sm font-medium text-gray-700">Nome Completo</label>
                                <input type="text" id="name" required className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border" />
                            </div>
                            <div>
                                <label htmlFor="email" className="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="email" required className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border" />
                            </div>
                            <div>
                                <label htmlFor="card" className="block text-sm font-medium text-gray-700">Número do Cartão</label>
                                <input type="text" id="card" required className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 p-2 border" />
                            </div>
                            <button
                                type="submit"
                                className="w-full bg-green-600 text-white font-bold py-3 rounded-lg shadow-lg hover:bg-green-700 transition-colors"
                            >
                                Confirmar Pagamento (R$ {cartTotal.toFixed(2)})
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        // Página de Agradecimento
        const ThankYou = () => (
            <div className="container mx-auto p-10 text-center">
                <div className="bg-green-100 border-l-4 border-green-500 text-green-700 p-6 rounded-lg shadow-md inline-block">
                    <h1 className="text-4xl font-bold mb-3">Obrigado pela sua compra!</h1>
                    <p className="text-lg">Seu pedido foi processado com sucesso. Você receberá um e-mail de confirmação em breve.</p>
                    <Link to="/shop" className="mt-6 inline-block bg-green-600 text-white font-semibold px-6 py-2 rounded-lg hover:bg-green-700 transition-colors">
                        Continuar Comprando
                    </Link>
                </div>
            </div>
        );

        // Páginas de Conteúdo (placeholders)
        const About = () => <div className="container mx-auto p-10"><h1 className="text-3xl font-bold">Sobre Nós</h1><p className="mt-4">Somos uma empresa dedicada a oferecer os melhores produtos com qualidade e preço justo. Fundada em 2023, nosso objetivo é... (Conteúdo mock)</p></div>;
        const Account = () => <div className="container mx-auto p-10"><h1 className="text-3xl font-bold">Minha Conta</h1><p className="mt-4">Aqui você pode gerenciar seus pedidos, endereços e dados pessoais. (Conteúdo mock)</p></div>;


        // --- COMPONENTE PRINCIPAL ---
        function App() {

            const [cart, setCart] = useState([]);
            const [showCart, setShowCart] = useState(false);

            function addToCart(product) {
                setCart(prev => {
                    const exists = prev.find(i => i.id === product.id);
                    if (exists) return prev.map(i => i.id === product.id ? { ...i, qty: i.qty + 1 } : i);
                    return [...prev, { ...product, qty: 1 }];
                });
            }

            function changeQty(id, delta) {
                setCart(prev =>
                    prev
                        .map(i => i.id === id ? { ...i, qty: Math.max(1, i.qty + delta) } : i)
                        .filter(i => i.qty > 0)
                );
            }

            function removeFromCart(id) {
                setCart(prev => prev.filter(i => i.id !== id));
            }

            function clearCart() {
                setCart([]);
            }

            const cartCount = cart.reduce((a, b) => a + b.qty, 0);

            // Calcula o subtotal dentro do render, ou usando useMemo (melhor performance)
            const cartSubtotal = useMemo(() => {
                return cart.reduce((s, i) => s + i.price * i.qty, 0).toFixed(2);
            }, [cart]);


            return (
                // O BrowserRouter é essencial para o roteamento do React
                <Router>
                    <div className="min-h-screen bg-gray-50 text-gray-900 flex flex-col">

                        {/* Cabeçalho e Carrinho */}
                        <Header cartCount={cartCount} onOpenCart={() => setShowCart(true)} />

                        <main className="flex-1">
                            {/* Rotas */}
                            <Routes>
                                <Route path="/" element={<Home />} />
                                <Route path="/shop" element={<Shop onAdd={addToCart} />} />
                                {/* O ProductPage usa useParams para ler o ID da URL */}
                                <Route path="/product/:id" element={<ProductPage onAdd={addToCart} />} />
                                <Route path="/about" element={<About />} />
                                <Route path="/account" element={<Account />} />
                                {/* O Checkout recebe o carrinho e a função de limpeza */}
                                <Route path="/checkout" element={<Checkout cart={cart} onClear={clearCart} />} />
                                <Route path="/thankyou" element={<ThankYou />} />
                                <Route path="*" element={<div className="p-10 text-center text-red-600">
                                    <h1 className="text-3xl font-bold">404</h1>
                                    <p>Página não encontrada.</p>
                                    <Link to="/" className="text-indigo-600 hover:underline">Voltar para o Início</Link>
                                </div>} />
                            </Routes>
                        </main>

                        {/* Rodapé */}
                        <Footer />

                        {/* Sidebar do Carrinho (Modal) */}
                        {showCart && (
                            <div
                                className="fixed inset-0 bg-black/50 backdrop-blur-sm z-20 flex justify-end"
                                onClick={() => setShowCart(false)}
                            >
                                {/* O div interno impede que o clique no modal feche o carrinho */}
                                <div className="w-full max-w-sm bg-white h-full p-6 shadow-2xl overflow-y-auto" onClick={(e) => e.stopPropagation()}>

                                    <div className="flex items-center justify-between border-b pb-3">
                                        <h4 className="text-xl font-bold text-gray-800">Seu Carrinho ({cartCount})</h4>
                                        <button
                                            onClick={() => setShowCart(false)}
                                            className="text-gray-500 hover:text-gray-900 transition-colors text-2xl"
                                            aria-label="Fechar carrinho"
                                        >
                                            &times;
                                        </button>
                                    </div>

                                    <div className="mt-6 space-y-4">
                                        {cart.length === 0 ? (
                                            <p className="text-gray-500 text-center py-10">Seu carrinho está vazio.</p>
                                        ) : (
                                            <>
                                                {cart.map(i => (
                                                    <div key={i.id} className="flex items-center gap-4 bg-gray-50 p-3 rounded-lg">
                                                        {/* Imagem do Produto */}
                                                        <img src={i.img} alt={i.title} className="w-16 h-20 object-cover rounded shadow-md" />

                                                        <div className="flex-1 min-w-0">
                                                            <Link to={`/product/${i.id}`} className="font-medium hover:text-indigo-600 transition-colors truncate block">{i.title}</Link>
                                                            <div className="text-sm text-gray-700">
                                                                R$ {i.price.toFixed(2)}
                                                            </div>

                                                            <div className="mt-2 flex items-center gap-3">
                                                                {/* Controle de Quantidade */}
                                                                <div className="flex items-center border rounded-lg overflow-hidden">
                                                                    <button onClick={() => changeQty(i.id, -1)} className="px-3 py-1 bg-gray-200 hover:bg-gray-300 transition-colors font-bold text-lg" aria-label="Diminuir quantidade">-</button>
                                                                    <span className="px-3 text-sm">{i.qty}</span>
                                                                    <button onClick={() => changeQty(i.id, 1)} className="px-3 py-1 bg-gray-200 hover:bg-gray-300 transition-colors font-bold text-lg" aria-label="Aumentar quantidade">+</button>
                                                                </div>
                                                                <button onClick={() => removeFromCart(i.id)} className="ml-auto text-sm text-red-600 hover:text-red-800 transition-colors font-medium">
                                                                    Remover
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}

                                                <div className="border-t pt-4 mt-6">
                                                    <div className="flex justify-between font-bold text-lg">
                                                        <span>Subtotal</span>
                                                        <strong>R$ {cartSubtotal}</strong>
                                                    </div>

                                                    <div className="mt-4 flex flex-col gap-3">
                                                        <Link
                                                            to="/checkout"
                                                            className="w-full text-center py-3 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-colors shadow-md"
                                                            onClick={() => setShowCart(false)}
                                                        >
                                                            Finalizar Compra
                                                        </Link>

                                                        <button
                                                            className="w-full py-3 rounded-lg border border-gray-300 text-gray-700 hover:bg-gray-100 transition-colors"
                                                            onClick={() => {
                                                                clearCart();
                                                                setShowCart(false);
                                                            }}
                                                        >
                                                            Limpar Carrinho
                                                        </button>
                                                    </div>
                                                </div>
                                            </>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}

                    </div>
                </Router>
            );
        }

        // Renderiza a aplicação no elemento root
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>